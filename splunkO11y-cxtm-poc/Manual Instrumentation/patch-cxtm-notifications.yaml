spec:
  template:
    spec:
      containers:
      - name: cxtm-notifications
        env:
        - name: OTEL_SERVICE_NAME
          value: "cxtm-notifications"
        - name: OTEL_EXPORTER_OTLP_ENDPOINT
          value: "http://otel-collector:4318"
        - name: OTEL_EXPORTER_OTLP_PROTOCOL
          value: "http/protobuf"
        - name: OTEL_PYTHON_LOGGING_AUTO_INSTRUMENTATION_ENABLED
          value: "true"
        - name: OTEL_PYTHON_LOG_CORRELATION
          value: "true"
        - name: OTEL_LOG_LEVEL
          value: "debug"
        command:
        - sh
        - -c
        - |
          echo "Installing OpenTelemetry..."
          pip install opentelemetry-distro opentelemetry-exporter-otlp
          opentelemetry-bootstrap --action=install
          echo "Starting instrumented application..."
          exec opentelemetry-instrument gunicorn cxtm_notifications:app -b [::]:8080 --worker-class=gthread --config=/app/src/gunicorn_conf.py --workers=4 --threads=4 --log-level=info